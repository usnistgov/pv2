#PV2 Example 1 - Net Metering, Cash Purchase, PPA Option, 
#Values are hard coded except those with a variable name comment to the right (e.g. # Study Period).

“userInput” :
[ {

	# Analysis Details

	“analysisObject” : 
	{
		”analysisType”: “LCC”,
		“projectType”: “Buildings”,
		“objToReport”: {"FlowSummary,MeasureSummary"},
		“studyPeriod”: 25,					# Study Period
		“baseDate”: 2021-01-01,
		“serviceDate”: 2021-01-01,
		“timestepVal”: “Year”,
		“timestepComp”: 1,
		“outputRealBool”: True,
		“interestRate”: 0.06,				#Nominal Interest Rate
		“dRateReal”: 0.06,					#Nominal Discount Rate
		“dRateNom: 0.0812,					#Real Discount Rate
		“inflationRate”: 0.02,				#General Inflation Rate
		“Marr”: 0.06,						#Real Discount Rate					
		“reinvestRate”: 0.06,				#Real Discount Rate
		“incomeRateFed”: {},
		“incomeRateOther”: {},
		“location”: ["United States","","","Maryland","","Silver Spring","20910",""]	#Location: ST, City, ZIP
	}

	# Alternative List
	# All values are hard coded.
	# alternative 2 only exists because PPA is selected
	
	"alternativeObjects": [
		{
			“altID”: 0,
			“altName”: “No Solar System”,
			“altBCNList”: [0,1],
			“baselineBool”: True
		},
		{
			“altID”: 1,
			“altName”: “Purchase Solar System”,
			“altBCNList”: [2,3,4,5,6,7,8,9,10],
			“baselineBool”: FALSE
		},
		{											
			“altID”: 2,
			“altName”: “PPA Solar System”,
			“altBCNList”: [11,12,13,14,15,16],
			“baselineBool”: FALSE
		}
	]

	# BCN Objects for all alternatives
	bcnObjects : [
		#Alternative 0 BCNs (Baseline - No Solar System)
		{
			“bcnID”: 0,
			“altID”: [0],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Electricity Consumption”,
			“bcnTag”: “Electricity”,
			“initialOcc”: 1,
			“bcnInvestBool”: FALSE,
			“bcnLife”: {},
			“rvBool”: FALSE,
			“recurBool”: TRUE,
			“recurInterval”: 1,
			“recurVarRate”: “percDelta”,
			“recurVarValue”: 0.02,							# Escalation Rate List or Constant Value
			“recurEndDate”: 25,								# Study Period
			“valuePerQ”: 0.126,								# Consumption Rate
			“quant”: 10000,									# Annual Consumption
			“quantVarRate”: “percDelta”,	
			“quantVarValue: 1.00,
			“quantUnit”: “kwh”
		},
		{
			“bcnID”: 1,
			“altID”: [0],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Electricity Demand Charge”,
			“bcnTag”: “Electricity”,
			“initialOcc”: 1,
			“bcnInvestBool”: FALSE,
			“bcnLife”: {},
			“rvBool”: FALSE,
			“recurBool”: TRUE,
			“recurInterval”: 1,
			“recurVarRate”: “percDelta”,
			“recurVarValue”: 0.0,
			“recurEndDate”: 25,								# Study Period
			“valuePerQ”: 96.12,								# Demand Charge
			“quant”: 1,
			“quantVarRate”: “percDelta”,
			“quantVarValue: 1.00,
			“quantUnit”: {} 
		}
		
		#Alternative 1 BCNs (Purchase of System)
		
		#Electricity Costs
		#Metering is Net (Net Metering). Consumption and production values matter and are dependent. 
		#There could be positive or negative net consumption depending on the year. 
		#For example, a PV system can produce excess electricity initially but will degrade over time and may not fully offset consumption in future years.
		#Since we assume constant consumption and declining production, the object creation can be broken into 2 scenarios: Year 1 Net Consumption > 0 ; Year 1 Net Consumption < 0 (i.e. excess production)
		#(Net Consumption)i = (Annual Consumption)i – (Annual Production)i
		#Create array of net consumption by year
		#Split into 2 arrays by year with positive net consumption (Net Annual Consumption) in one and negative net consumption (Net Annual Production) in the other with zero values for years in which that array has no value. These can be used as the arrays for the Q variability and then set initial Q = 1
		#(this allows for creating the E3 objects that can use the right price)
		#If Annual Production < Annual Consumption, then consumption is always greater than production. So each year there is positive consumption (no excess production) – this assumes net metering balanced once a year. So there is only the net annual consumption object.
		#If Annual Production > Annual Consumption, then consumption is initially less than production. Its possible to have both a consumption object and a production object since prices could be different.
		#Excess Production occurs in years 1-6; net consumption is positive years 7-25
		#Net Consumption starts at a very small number and increases a lot on a percentage basis.
		#We are using an approach to simplify. Set quantity equal to 1 and then have the variability be equal to the quantity.
		
		{
			“bcnID”: 2,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Electricity Consumption”,
			“bcnTag”: “Electricity”,
			“initialOcc”: 7,								# Year that consumption > production
			“bcnInvestBool”: FALSE,
			“bcnLife”: {},
			“rvBool”: FALSE,
			“recurBool”: TRUE,
			“recurInterval”: 1,
			“recurVarRate”: “percDelta”,
			“recurVarValue”: 0.02,							# Escalation Rate List or Constant Value for Consumption
			“recurEndDate”: 25,								# Study Period
			“valuePerQ”: 0.126,								# Consumption Rate
			“quant”: 9,										# =(Annual Consumption)-(Annual Production) in Year = initialOcc
			“quantVarRate”: “percDelta”,	
			“quantVarValue: [1.00,5.72,0.85,0.46,0.31,0.24,0.19,0.16,0.14,0.12,0.11,0.10,0.09,0.08,0.07,0.07,0.06,0.06], #Percent change year over year
			“quantUnit”: “kwh”
		},
		{
			“bcnID”: 3,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Electricity Demand Charge”,
			“bcnTag”: “Electricity”,
			“initialOcc”: 1,
			“bcnInvestBool”: FALSE,
			“bcnLife”: {},
			“rvBool”: FALSE,
			“recurBool”: TRUE,
			“recurInterval”: 1,
			“recurVarRate”: “percDelta”,
			“recurVarValue”: 0.0,
			“recurEndDate”: 25,								# Study Period
			“valuePerQ”: 96.12,								# Demand Charge
			“quant”: 1,
			“quantVarRate”: “percDelta”,
			“quantVarValue: 1.00
			“quantUnit”: {}
		}
		{
			“bcnID”: 4,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Electricity Production”,
			“bcnTag”: “Electricity”,
			“initialOcc”: 1,								# First year production > consumption
			“bcnInvestBool”: False,
			“bcnLife”: {},
			“rvBool”: False,
			“recurBool”: True,
			“recurInterval”: 1,
			“recurVarRate”: “percDelta”,
			“recurVarValue”: 0.01,							# Escalation Rate List or Constant Value for Excess Production
			“recurEndDate”: 6,								# Last year production > consumption
			“valuePerQ”: -0.059,							# Excess Production Rate
			“quant”: 300,									# =(Annual Production)-(Annual Consumption) in Year = initialOcc
			“quantVarRate”: “percDelta”,	
			“quantVarValue: [1.00,-0.17,-0.21,-0.26,-0.35,-0.55], #
			“quantUnit”: “kwh”
		},
		{
			“bcnID”: 5,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “PV Grid Connection Fee”,
			“bcnTag”: “Electricity”,
			“initialOcc”: 1,
			“bcnInvestBool”: False,
			“bcnLife”: {},
			“rvBool”: False,
			“recurBool”: True,
			“recurInterval”: 1,
			“recurVarRate”: “percDelta”,
			“recurVarValue”: 0.0,
			“recurEndDate”: 25,								# Study Period
			“valuePerQ”: 0.0,								# PV Connection Fee
			“quant”: 1,
			“quantVarRate”: “percDelta”,
			“quantVarValue: 1.00,
			“quantUnit”: {}
		}

		#System Costs
		#Cash Purchase Solar PV System
		#Capital Component: Solar PV system, Initial purchase price, Tax credit, Grants/rebates, Maintenance costs, Inverter replacement costs, Residual Value = f(residual value approach)
		# This assumes that we use a linear depreciation approach to residual value.
		{
			“bcnID”: 6,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Total Installation Costs”,
			“bcnTag”: “Investment Costs”,
			“initialOcc”: 0,
			“bcnInvestBool”: True,
			“bcnLife”: 25,
			“rvBool”: False,
			“recurBool”: False,
			“recurInterval”: {},
			“recurVarRate”: {},
			“recurVarValue”: {},
			“recurEndDate”: {},								
			“valuePerQ”: 35280,								# Total Installation Cost
			“quant”: 1,
			“quantVarRate”: {},
			“quantVarValue: {},
			“quantUnit”: {}
		}
		{
			“bcnID”: 7,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Total Installation Costs Residual Value”,
			“bcnTag”: “Investment Costs”,
			“initialOcc”: 25,				# Study Period
			“bcnInvestBool”: True,
			“bcnLife”: {},
			“rvBool”: False,
			“recurBool”: False,
			“recurInterval”: {},
			“recurVarRate”: {},
			“recurVarValue”: {},
			“recurEndDate”: {},								
			“valuePerQ”: 0,				# Includes (system minus inverter) and (inverter); RV = 0 because system has 25 year service life
			“quant”: 1,
			“quantVarRate”: {},
			“quantVarValue: {},
			“quantUnit”: {}
		}
		{
			“bcnID”: 8,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “Federal Tax Credit”,
			“bcnTag”: “Investment Costs”,
			“initialOcc”: 1,						
			“bcnInvestBool”: 25,
			“bcnLife”: {},
			“rvBool”: False,
			“recurBool”: False,
			“recurInterval”: {},
			“recurVarRate”: {},
			“recurVarValue”: {},
			“recurEndDate”: {},								
			“valuePerQ”: -9173,				# Federal Tax credit = 0.26 * Total Installation Costs
			“quant”: 1,
			“quantVarRate”: {},
			“quantVarValue: {},
			“quantUnit”: {}
		}
		{
			“bcnID”: 9,
			“altID”: [1],
			“bcnType”: “Cost”,
			“bcnSubType”: “Direct”,
			“bcnName”: “GrantsRebates”,
			“bcnTag”: “Investment Costs”,
			“initialOcc”: 1,						
			“bcnInvestBool”: True,
			“bcnLife”: 25,
			“rvBool”: False,
			“recurBool”: False,
			“recurInterval”: {},
			“recurVarRate”: {},
			“recurVarValue”: {},
			“recurEndDate”: {},								
			“valuePerQ”: -1000,				# Federal Tax credit = 0.26 * Total Installation Costs
			“quant”: 1,
			“quantVarRate”: {},
			“quantVarValue: {},
			“quantUnit”: {}
		}


		BCN Object {
		9,					# BCN ID
		GrantsRebates,				#Object Name
		1,					#Alternative ID
		Cost, 					#Type
		Direct,					#SubType
		Investment Costs,			#Tag
		Real,					#NominalOrReal
		YES,					#Investment
		1,					#DateofOccurrence
		25,				#InvestmentServiceLife
		NO,					#CalculateResidualValue
		NO,					#Recurrence
		BLANK,					#RecurrenceInterval
		BLANK,					#RecurrenceVariabilityRateType
		{BLANK},				# RecurrenceVariabilityRateValues
		BLANK,					#RecurrenceEndDate
		-1000,			#ValuePerQ – Based on 2021 MD state rebate program
		1,					#Quantity
		BLANK,					#QuantityVariabilityRateType
		{BLANK},				#QuantityVariabilityRateValues
		BLANK					#Quantity Unit
		}

		BCN Object {
		10,					# BCN ID
		Maintenance Costs,			#Object Name
		1,					#Alternative ID
		Cost, 					#Type
		Direct,					#SubType
		Maintenance Costs,			#Tag
		Real,					#NominalOrReal
		NO,					#Investment
		1,					#DateofOccurrence
		BLANK,					#InvestmentServiceLife
		NO,					#CalculateResidualValue
		YES,					#Recurrence
		1,					#RecurrenceInterval
		BLANK,					#RecurrenceVariabilityRateType
		{BLANK},				# RecurrenceVariabilityRateValues
		BLANK,					#RecurrenceEndDate
		0,		#ValuePerQ – Based on2020 tax credit value
		1,					#Quantity
		BLANK,					#QuantityVariabilityRateType
		{BLANK},				#QuantityVariabilityRateValues
		BLANK					#Quantity Unit
		}


		#Alternative 2 – PPA / Lease (Optional)
		#Lease to Own Solar PV System
		#The costs include Grid Consumption Costs from Net Consumption at a lower price and PV produced consumption at a lower price
		# Total Consumption is a combination of grid and solar PV based electricity
		# Instead of having a purchase cost, there are PPA payments for solar PV production
		# Grid costs are the same as in the purchase case.

		BCN Object {
		11,					# BCN ID
		Electricity Consumption - Grid,		#Object Name (hard coded)
		2,					#AlternativeID
		Cost,					#Type
		Direct,					#SubType
		Electricity,				#Tag
		Constant,				#Current or Constant Dollars
		No,					#Investment
		7,					#DateofOccurrence
		BLANK,					#InvestmentServiceLife
		BLANK,					#CalculateResidualValue
		Yes,					#Recurrence
		1,					#RecurrenceInterval
		percDelta,		#RecurrenceVariabilityRateType
		{1.00}, 		# RecurrenceVariabilityRateValues
		25,				#RecurrenceEndDate
		0.126,			#ValuePerQ
		1,					#Set Quantity = 1 and use to make it each to define variability rate = quantity
		Percent Timestep 1,			#QuantityVariabilityRateType
		{9,60.5,112,163.5,215,266.5,318,369.5,421,472.5,524,575.5,627,678.5,730,781.5,833,884.5,936}, #QuantityVariabilityRateValues
		Kwh,					#Quantity Unit
		}

		BCN Object {
		12,					# BCN ID
		Electricity Demand Charge - Grid,		#Object Name (hard coded)
		2,					#AlternativeID
		Cost,					#Type
		Direct,					#SubType
		Electricity,				#Tag
		Constant,				#Current or Constant Dollars
		No,					#Investment
		1,					#DateofOccurrence
		BLANK,					#InvestmentServiceLife
		BLANK,					#CalculateResidualValue
		Yes,					#Recurrence
		1,					#RecurrenceInterval
		percDelta,		#RecurrenceVariabilityRateType
		{0.0},					# RecurrenceVariabilityRateValues
		25,				#RecurrenceEndDate
		96.12,			#ValuePerQ
		1,					#Quantity
		BLANK,					#QuantityVariabilityRateType
		{BLANK},				#QuantityVariabilityRateValues
		,					#Quantity Unit
		}

		BCN Object {
		13,					# BCN ID
		Electricity Production - Grid,			#Object Name (hard coded)
		2,					#AlternativeID
		Cost,					#Type
		Direct,					#SubType
		Electricity,				#Tag
		Constant,				#Current or Constant Dollars
		No,					#Investment
		1,					#DateofOccurrence
		BLANK,					#InvestmentServiceLife
		BLANK,					#CalculateResidualValue
		Yes,					#Recurrence
		1,					#RecurrenceInterval
		percDelta,		#RecurrenceVariabilityRateType
		{Escalation Rate Array},			# RecurrenceVariabilityRateValues
		6,				#RecurrenceEndDate
		-0.059,		#ValuePerQ
		300,					#Quantity
		Percent Timestep X-1,			#QuantityVariabilityRateType
		{1.00,0.83,0.79,0.74,0.65,0.45},				#QuantityVariabilityRateValues
		Kwh,					#Quantity Unit
		}

		BCN Object {
		14,					# BCN ID
		Electricity Consumption - PPA,		#Object Name (hard coded)
		2,					#AlternativeID
		Cost,					#Type
		Direct,					#SubType
		Electricity,				#Tag
		Constant,				#Current or Constant Dollars
		No,					#Investment
		1,					#DateofOccurrence
		BLANK,					#InvestmentServiceLife
		BLANK,					#CalculateResidualValue
		Yes,					#Recurrence
		1,					#RecurrenceInterval
		percDelta,		#RecurrenceVariabilityRateType
		{0.01},		# RecurrenceVariabilityRateValues
		25,				#RecurrenceEndDate
		0.10,			#ValuePerQ
		10300,			#Quantity
		Percent Timestep 0,			#QuantityVariabilityRateType
		{0.995,0.990,0.985,0.980,0.975,0.970,0.965,0.960,0.955,0.950,0.945,0.940,0.935,0.930,0.925,0.920,0.915,0.910,0.905,0.900,0.895,0.890,0.885,0.880},	#QuantityVariabilityRateValues
		Kwh,					#Quantity Unit
		}

		BCN Object {
		15,					# BCN ID
		PPA Purchase Price,			#Object Name
		2,					#Alternative ID
		Cost, 					#Type
		Direct,					#SubType
		Investment Costs,			#Tag
		Real,					#NominalOrReal
		YES,					#Investment
		25,			#DateofOccurrence
		25,	#InvestmentServiceLife
		NO,					#CalculateResidualValue
		NO,					#Recurrence
		BLANK,					#RecurrenceInterval
		BLANK,					#RecurrenceVariabilityRateType
		{BLANK},				# RecurrenceVariabilityRateValues
		BLANK,					#RecurrenceEndDate
		1000,			#ValuePerQ
		1,					#Quantity
		BLANK,					#QuantityVariabilityRateType
		{BLANK},				#QuantityVariabilityRateValues
		BLANK					#Quantity Unit
		}

		BCN Object {
		16,					# BCN ID
		Residual Value,				#Object Name
		2,					#Alternative ID
		Cost, 					#Type
		Direct,					#SubType
		Investment Costs,			#Tag
		Real,					#NominalOrReal
		YES,					#Investment
		Study Period,				#DateofOccurrence
		,					#InvestmentServiceLife
		NO,					#CalculateResidualValue
		NO,					#Recurrence
		BLANK,					#RecurrenceInterval
		BLANK,					#RecurrenceVariabilityRateType
		{BLANK},				# RecurrenceVariabilityRateValues
		BLANK,					#RecurrenceEndDate
		0,			#ValuePerQ – Includes (system minus inverter) and (inverter); assumed RV = 0 because end of service life
		1,					#Quantity
		BLANK,					#QuantityVariabilityRateType
		{BLANK},				#QuantityVariabilityRateValues
		BLANK					#Quantity Unit
		}
	]
} ]

# JSON Output File Format
“e3Output” :[
AlternativeSummaryObjects:[
	{	#No System
	0,	#AlternativeID,
	0,	 #Total PV Benefits
	19458.84, #Total PV Costs
	0, #Total Investment Cost
	19458.84, #Total Non-Investment Cost
	0, #NB,
	0,	#NS or Net Profit,
	null,	#SIR or Net Profit to Investment Ratio,
	null,	#IRR, (optional)
	null,	#AIRR,
	null,	#SPB,
	null,	#DPB,
	null,	#(Total Benefits – Total Investment Costs) / Total Investment Costs
	{250000}, #Total Quantities – sum by tag
	{kwh},	#Quantities Units
	0.06,	#MARR/Hurdle Rate – Comes from Analysis Object (user must supply/calculate)
	{0},	#Delta Quantity Array using Tags,
	{null}, 	#NS / Quantity Change Array,
	{null},	#NS / % Quantity Change Array,
	{null},	#NS Elasticity to Quantity Change Array
	},
	
	{	#Solar PV System Purchase
	1,	#AlternativeID,
	0,	 #Total PV Benefits
	-36740, #Total PV Costs
	25107, #Total Investment Cost
	-61847, #Total Non-Investment Cost
	0, #NB,
	36740,	#NS or Net Profit,
	2.46,	#SIR or Net Profit to Investment Ratio,
	null,	#IRR, (optional)
	0.0989,	#AIRR,
	5,	#SPB,
	6,	#DPB,
	0,	#(Total Benefits – Total Investment Costs) / Total Investment Costs
	{X1,…}, #Total Quantities – sum by tag
	{TBD},	#Quantities Units
	0.06,	#MARR/Hurdle Rate – Comes from Analysis Object (user must supply/calculate)
	{TBD},	#Delta Quantity Array using Tags,
	{TBD}, 	#NS / Quantity Change Array,
	{TBD},	#NS / % Quantity Change Array,
	{TBD},	#NS Elasticity to Quantity Change Array
	},
	
	{	#PPA / Lease
	2,	#AlternativeID,	
	0,	 #Total PV Benefits
	15012.2, #Total PV Costs
	0, #Total Investment Cost
	15012.2, #Total Non-Investment Cost
	0, #NB,
	4446.64,	#NS or Net Profit,
	null,	#SIR or Net Profit to Investment Ratio,
	null,	#IRR, (optional)
	null,	#AIRR,
	1,	#SPB,
	1,	#DPB,
	null,	#(Total Benefits – Total Investment Costs) / Total Investment Costs
	{X1,…}, #Total Quantities – sum by tag
	{ },	#Quantities Units
	0.06,	#MARR/Hurdle Rate – Comes from Analysis Object (user must supply/calculate)
	{},	#Delta Quantity Array using Tags,
	{}, 	#NS / Quantity Change Array,
	{},	#NS / % Quantity Change Array,
	{},	#NS Elasticity to Quantity Change Array
	}
],
CASH FLOW OBJECTS TBD
}]
